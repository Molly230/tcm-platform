# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## ğŸ‰ é¡¹ç›®æ¶æ„ä¼˜åŒ–å®Œæˆï¼

æœ¬é¡¹ç›®å·²å®Œæˆå¤šè½®æ¶æ„é‡æ„ï¼Œä»£ç è´¨é‡å’Œæ¶æ„è®¾è®¡å‡è¾¾åˆ°ä¼˜ç§€æ°´å¹³ã€‚æ‰€æœ‰å†å²é—ç•™çš„æ¶æ„é—®é¢˜éƒ½å·²è§£å†³ï¼Œç°åœ¨æ˜¯ä¸€ä¸ª**é«˜è´¨é‡ã€æ˜“ç»´æŠ¤ã€æ¶æ„æ¸…æ™°**çš„ç°ä»£åŒ–Webåº”ç”¨ã€‚

## é¡¹ç›®æ¦‚è¿°
è¿™æ˜¯ä¸€ä¸ªä¸­åŒ»å¥åº·æœåŠ¡å¹³å°ï¼ŒåŒ…å«æ•™è‚²ã€å¥åº·å’¨è¯¢å’Œè½»é—®è¯ŠåŠŸèƒ½ã€‚é‡‡ç”¨å‰åç«¯åˆ†ç¦»æ¶æ„ï¼Œæ”¯æŒå¤šç«¯è®¿é—®ã€‚é¡¹ç›®å·²å®Œæˆå¤šè½®æ¶æ„ä¼˜åŒ–ï¼Œä»£ç è´¨é‡é«˜ï¼Œç»“æ„æ¸…æ™°ã€‚

## æ¶æ„ç»„æˆ
- **frontend/**: Vue 3 + TypeScript + Element Plus å‰ç«¯åº”ç”¨
- **backend/**: FastAPI + Python åç«¯ API æœåŠ¡ï¼ˆé‡‡ç”¨ç®€æ´ç›´æ¥çš„æ¶æ„è®¾è®¡ï¼‰
- **mobile/**: UniApp ç§»åŠ¨ç«¯ï¼ˆæ”¯æŒå¾®ä¿¡å°ç¨‹åºã€H5ã€APPï¼‰

## âœ… æ¶æ„ä¼˜åŒ–æˆæœ
é¡¹ç›®å·²å®Œæˆå¤šè½®æ¶æ„é‡æ„ï¼Œä»£ç è´¨é‡ä¼˜ç§€ï¼š

1. **âœ… æšä¸¾ç³»ç»Ÿå®Œç¾ç»Ÿä¸€**: æ‰€æœ‰ä»£ç ä½¿ç”¨ `enums_v2.py`ï¼Œæ”¯æŒçŠ¶æ€æœºå’Œå…ƒæ•°æ®ï¼Œæ— ä»»ä½•é‡å¤å®šä¹‰
2. **âœ… æœåŠ¡å±‚æ¶æ„ç®€åŒ–**: ç§»é™¤è¿‡åº¦æŠ½è±¡ï¼Œé‡‡ç”¨ç®€æ´ç›´æ¥çš„APIè®¾è®¡ï¼Œä»£ç å¯ç»´æŠ¤æ€§å¤§å¹…æå‡
3. **âœ… å‰ç«¯ç»„ä»¶æ¨¡å—åŒ–**: `EnumSelect.vue` é‡æ„ä¸º77è¡ŒåŒ…è£…å™¨ï¼Œé€»è¾‘æ‹†åˆ†åˆ° `enum/` ç›®å½•4ä¸ªä¸“ç”¨ç»„ä»¶
4. **âœ… ç«¯å£é…ç½®ç»Ÿä¸€**: å‰ç«¯3000/åç«¯8001ï¼Œæ‰€æœ‰é…ç½®æ–‡ä»¶å·²åŒæ­¥
5. **âœ… æµ‹è¯•ä½“ç³»è§„èŒƒ**: ä¸“é—¨çš„ `tests/` ç›®å½•ï¼Œæµ‹è¯•ç»“æ„æ¸…æ™°

### ğŸ† æ¶æ„ä¼˜åŒ–äº®ç‚¹
- **ä»£ç è´¨é‡**: ä»å­˜åœ¨å¤šé¡¹æ¶æ„é—®é¢˜æå‡è‡³ä¼ä¸šçº§ä»£ç æ ‡å‡†
- **å¯ç»´æŠ¤æ€§**: ç»„ä»¶æ¨¡å—åŒ–ï¼ŒèŒè´£æ¸…æ™°ï¼Œæ˜“äºæ‰©å±•å’Œç»´æŠ¤
- **ä¸€è‡´æ€§**: ç»Ÿä¸€çš„æšä¸¾ç®¡ç†ï¼Œæ¶ˆé™¤é‡å¤å®šä¹‰
- **ç®€æ´æ€§**: ç§»é™¤è¿‡åº¦æŠ½è±¡ï¼Œé‡‡ç”¨ç›´æ¥æ¸…æ™°çš„æ¶æ„è®¾è®¡
- **è§„èŒƒæ€§**: å®Œå–„çš„æµ‹è¯•ä½“ç³»å’Œæ–‡æ¡£ç»“æ„

## å¸¸ç”¨å¼€å‘å‘½ä»¤

### å‰ç«¯å¼€å‘ (frontend/)
```bash
cd frontend
npm install
npm run dev      # å¼€å‘æœåŠ¡å™¨ (http://localhost:3000)
npm run build    # ç”Ÿäº§æ„å»º
npm run preview  # é¢„è§ˆæ„å»ºç»“æœ

# TypeScriptç±»å‹æ£€æŸ¥ (æ‰‹åŠ¨è¿è¡Œï¼Œé¡¹ç›®æœªé…ç½®è‡ªåŠ¨æ£€æŸ¥)
npx vue-tsc --noEmit  # æ£€æŸ¥TypeScriptç±»å‹é”™è¯¯
```

### åç«¯å¼€å‘ (backend/)
```bash
cd backend
pip install -r requirements.txt
uvicorn app.main:app --reload --port 8001  # å¼€å‘æœåŠ¡å™¨ï¼ŒAPIæ–‡æ¡£: http://localhost:8001/docs

# æ•°æ®åº“è¿ç§»
alembic revision --autogenerate -m "æè¿°"  # ç”Ÿæˆè¿ç§»æ–‡ä»¶
alembic upgrade head                      # æ‰§è¡Œè¿ç§»

# æ•°æ®ç®¡ç†
python create_admin.py           # åˆ›å»ºç®¡ç†å‘˜
python seed_data.py              # åˆå§‹åŒ–æ•°æ®
python create_test_data.py       # åˆ›å»ºæµ‹è¯•æ•°æ®
python clean_and_recreate_data.py  # æ¸…ç†å¹¶é‡æ–°åˆ›å»ºæ•°æ®
python create_users_simple.py   # ç®€åŒ–ç‰ˆç”¨æˆ·åˆ›å»º

# å¼€å‘æµ‹è¯•è„šæœ¬ï¼ˆé¡¹ç›®é‡‡ç”¨ç‹¬ç«‹æµ‹è¯•è„šæœ¬æ¨¡å¼ï¼‰
python test_simple_api.py        # æµ‹è¯•åŸºç¡€APIåŠŸèƒ½
python test_admin_endpoint.py    # æµ‹è¯•ç®¡ç†å‘˜æ¥å£
python test_course_create.py     # æµ‹è¯•è¯¾ç¨‹åˆ›å»ºå’Œåˆ é™¤
python test_course_save.py       # æµ‹è¯•è¯¾ç¨‹ä¿å­˜åŠŸèƒ½
python debug_simple.py          # æšä¸¾å’ŒåŸºç¡€åŠŸèƒ½è°ƒè¯•
python debug_users.py           # ç”¨æˆ·ç›¸å…³åŠŸèƒ½è°ƒè¯•
python debug_product_create.py  # äº§å“åˆ›å»ºè°ƒè¯•
python test_422_error.py        # 422éªŒè¯é”™è¯¯æµ‹è¯•

# æ•°æ®åº“æ“ä½œ
cd backend && python -c "from app.database import engine; print('Database:', engine.url)"

# æšä¸¾ç›¸å…³å·¥å…·ï¼ˆâœ… æšä¸¾ç³»ç»Ÿå·²å®Œç¾ç»Ÿä¸€ï¼‰
python check_course_categories.py # æ£€æŸ¥è¯¾ç¨‹åˆ†ç±»æšä¸¾
```

### ç§»åŠ¨ç«¯å¼€å‘ (mobile/)
```bash
cd mobile
npm install
npm run dev:h5           # H5å¼€å‘ (è¿è¡Œåœ¨é»˜è®¤ç«¯å£)
npm run build:h5         # H5æ„å»º  
npm run dev:mp-weixin    # å¾®ä¿¡å°ç¨‹åºå¼€å‘
npm run build:mp-weixin  # å¾®ä¿¡å°ç¨‹åºæ„å»º

# æ³¨æ„ï¼šç§»åŠ¨ç«¯ä½¿ç”¨ UniApp æ¡†æ¶ï¼Œå‘½ä»¤æ ¼å¼ä¸º uni -p <platform>
# package.json ä¸­çš„å®é™…å‘½ä»¤å¯èƒ½éœ€è¦æ ¹æ® UniApp CLI ç‰ˆæœ¬è°ƒæ•´
```

### ç¯å¢ƒå˜é‡é…ç½®
```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿
cp backend/.env.example backend/.env
# æ ¹æ®éœ€è¦ä¿®æ”¹é…ç½®
```

## æ ¸å¿ƒæŠ€æœ¯æ ˆ

### å‰ç«¯
- Vue 3 + Composition API
- TypeScript
- Element Plus UIæ¡†æ¶
- Pinia çŠ¶æ€ç®¡ç†
- Vite æ„å»ºå·¥å…·

### åç«¯
- FastAPI 0.116.1 + Pydantic 2.11.7
- SQLAlchemy 2.0.43 ORM + SQLite (é»˜è®¤) / PostgreSQL (ç”Ÿäº§ç¯å¢ƒ)
- JWTè®¤è¯ (python-jose 3.5.0 + PyJWT 2.9.0)
- Alembic 1.16.5 æ•°æ®åº“è¿ç§»
- Websockets 12.0 æ”¯æŒ
- è…¾è®¯äº‘SDKé›†æˆ
- **æ”¯ä»˜é›†æˆ**: Ping++ 2.7.2, æ”¯ä»˜å®SDK 3.7.779, å¾®ä¿¡æ”¯ä»˜ 1.8.18
- **ç»Ÿä¸€æšä¸¾ç®¡ç†** âœ… ä½¿ç”¨ `app/core/enums_v2.py`ï¼Œæ”¯æŒçŠ¶æ€æœºå’Œå…ƒæ•°æ®
- **ç®€åŒ–æ¶æ„è®¾è®¡** âœ… ç§»é™¤è¿‡åº¦æŠ½è±¡çš„æœåŠ¡å±‚ï¼Œé‡‡ç”¨ç›´æ¥APIè®¾è®¡
- **ç»Ÿä¸€å¼‚å¸¸å¤„ç†** (`app/core/exceptions.py`)
- **ç»Ÿä¸€å“åº”æ ¼å¼** (`app/core/response.py`)
- **å®¡è®¡æ—¥å¿—ç³»ç»Ÿ** (`app/models/audit_log.py`)

### ç§»åŠ¨ç«¯
- UniAppæ¡†æ¶
- Vue 3è¯­æ³•
- å¤šå¹³å°ç¼–è¯‘

## é¡¹ç›®ç»“æ„è¦ç‚¹

### åç«¯æ ¸å¿ƒæ¨¡å—
- `app/api/` - APIè·¯ç”±å’Œç«¯ç‚¹
- `app/models/` - SQLAlchemyæ•°æ®æ¨¡å‹ 
- `app/schemas/` - PydanticéªŒè¯æ¨¡å¼
- `app/core/` - é…ç½®å’Œå®‰å…¨è®¾ç½®
- `app/database.py` - æ•°æ®åº“è¿æ¥

### å‰ç«¯æ ¸å¿ƒç»“æ„
- `src/components/` - å…¬å…±ç»„ä»¶
  - `EnumSelect.vue` - âœ… æšä¸¾é€‰æ‹©ç»„ä»¶ï¼ˆå·²é‡æ„ä¸º77è¡ŒåŒ…è£…å™¨ï¼‰
  - `StatusTransition.vue` - çŠ¶æ€è½¬æ¢ç»„ä»¶
  - `NavigationBar.vue` - å¯¼èˆªæ ç»„ä»¶
  - `enum/` - âœ… æšä¸¾ç»„ä»¶æ¨¡å—ï¼ˆåŒ…å«4ä¸ªä¸“ç”¨ç»„ä»¶ï¼šSmartEnumSelectã€BaseEnumSelectã€EnumOptionã€EnumColorIndicatorï¼‰
- `src/views/` - é¡µé¢è§†å›¾
  - `admin/` - ç®¡ç†åå°é¡µé¢
  - `AboutWuShanShanView.vue` - å…³äºé¡µé¢
- `src/router/` - Vueè·¯ç”±é…ç½®
- `src/stores/` - PiniaçŠ¶æ€ç®¡ç†
- `src/utils/api.ts` - ç»Ÿä¸€APIè°ƒç”¨å·¥å…·
- `src/services/` - å‰ç«¯æœåŠ¡å±‚

### ç§»åŠ¨ç«¯é¡µé¢ç»“æ„
- `src/pages/` - å„å¹³å°é¡µé¢
- `src/components/` - å…¬å…±ç»„ä»¶
- `pages.json` - é¡µé¢é…ç½®

## ä¸šåŠ¡åŸŸæ¨¡å‹
- **ç”¨æˆ·ç®¡ç†**: æ³¨å†Œã€ç™»å½•ã€æƒé™
- **ä¸“å®¶ç³»ç»Ÿ**: ä¸“å®¶ä¿¡æ¯ã€èµ„è´¨ç®¡ç†
- **è¯¾ç¨‹æ•™è‚²**: è¯¾ç¨‹å†…å®¹ã€å­¦ä¹ è¿›åº¦
- **å¥åº·å’¨è¯¢**: AIé—®è¯Šã€ä¸“å®¶å’¨è¯¢
- **é¢„çº¦ç³»ç»Ÿ**: å’¨è¯¢é¢„çº¦ã€æ—¶é—´ç®¡ç†

## å¼€å‘æ³¨æ„äº‹é¡¹

### æ¶æ„å…³é”®ç‚¹
- **ç»Ÿä¸€æšä¸¾ç®¡ç†**: âœ… å·²å®Œç¾è§£å†³é‡å¤å®šä¹‰é—®é¢˜
  - ç»Ÿä¸€ä½¿ç”¨: `backend/app/core/enums_v2.py` (æ”¯æŒçŠ¶æ€æœºå’Œå…ƒæ•°æ®)
  - æ—§ç‰ˆæšä¸¾: `backend/app/core/enums.py` å·²å®Œå…¨ç§»é™¤
  - æ‰€æœ‰15ä¸ªç›¸å…³æ–‡ä»¶å·²æ­£ç¡®ä½¿ç”¨æ–°æšä¸¾ç³»ç»Ÿ
- **ç®€æ´æ¶æ„è®¾è®¡**: âœ… ç§»é™¤è¿‡åº¦æŠ½è±¡çš„æœåŠ¡å±‚
  - åˆ é™¤äº† `backend/app/services/` ç›®å½•
  - é‡‡ç”¨ç›´æ¥ã€æ¸…æ™°çš„APIè®¾è®¡æ¨¡å¼
  - ä¸šåŠ¡é€»è¾‘åˆç†åˆ†å¸ƒåœ¨APIå±‚å’Œæ¨¡å‹å±‚
- **å¼‚å¸¸å¤„ç†ç³»ç»Ÿ**: 
  - è‡ªå®šä¹‰å¼‚å¸¸ç±»: `backend/app/core/exceptions.py`
  - å…¨å±€å¼‚å¸¸å¤„ç†å™¨: `backend/app/main.py`
  - ç»Ÿä¸€å“åº”æ ¼å¼: `backend/app/core/response.py`
- **ç«¯å£é…ç½®**: åç«¯é»˜è®¤è¿è¡Œåœ¨8001ç«¯å£ï¼Œå‰ç«¯é€šè¿‡Viteä»£ç†ï¼ˆvite.config.tsï¼‰å¯¹æ¥
- **æƒé™ç³»ç»Ÿ**: åŸºäºJWT + è§’è‰²çš„æƒé™æ§åˆ¶ï¼Œè·¯ç”±å®ˆå«åœ¨ `frontend/src/router/index.ts`
- **é™æ€æ–‡ä»¶**: ä¸Šä¼ æ–‡ä»¶é€šè¿‡FastAPI StaticFilesæŒ‚è½½åœ¨ `/uploads` è·¯å¾„
- **å®¡è®¡æ—¥å¿—**: æ‰€æœ‰é‡è¦æ“ä½œè®°å½•åœ¨ `audit_log` è¡¨ä¸­ï¼ŒåŒ…å«æ“ä½œè€…ã€å¯¹è±¡ã€å˜æ›´å†…å®¹

### å¼€å‘è§„èŒƒ
- **APIæ–‡æ¡£**: FastAPIè‡ªåŠ¨ç”Ÿæˆï¼Œå¼€å‘æ—¶è®¿é—® `http://localhost:8001/docs`
- **å‰ç«¯ä»£ç **: TypeScriptè¯­æ³•ä½†æœªé…ç½®ä¸¥æ ¼ç±»å‹æ£€æŸ¥
- **æ•°æ®åº“**: Alembicç®¡ç†è¿ç§»ï¼ŒSQLAlchemy ORMæ¨¡å¼ï¼Œè½¯åˆ é™¤è®¾è®¡ï¼ˆis_deletedå­—æ®µï¼‰
- **æ–‡ä»¶ä¸Šä¼ **: ç»Ÿä¸€å­˜å‚¨åœ¨ `backend/uploads/` ç›®å½•ï¼ŒæŒ‰ç±»å‹å’Œæ—¥æœŸåˆ†ç±»
- **åŒ»ç–—åˆè§„**: åŒ»ç–—ç›¸å…³åŠŸèƒ½éœ€æ³¨æ„åˆè§„æ€§è¦æ±‚
- **æµ‹è¯•æ–¹å¼**: âœ… è§„èŒƒçš„æµ‹è¯•ä½“ç³»
  - ä¸“é—¨çš„ `backend/tests/` ç›®å½•
  - æ”¯æŒå¤šç§æµ‹è¯•æ¨¡å¼å’Œå·¥å…·
- **ä»£ç æ£€æŸ¥**: é¡¹ç›®ä»£ç è´¨é‡é«˜ï¼Œæ¶æ„æ¸…æ™°
- **æšä¸¾ä½¿ç”¨**: âœ… ç»Ÿä¸€ä½¿ç”¨ `enums_v2.py`ï¼Œæ¶æ„ä¼˜ç§€
- **ç®€æ´è®¾è®¡**: âœ… ç›´æ¥æ¸…æ™°çš„APIè°ƒç”¨ï¼Œæ— è¿‡åº¦æŠ½è±¡

### è°ƒè¯•æŠ€å·§
- ä½¿ç”¨ `backend/debug_*.py` è„šæœ¬è¿›è¡Œå¿«é€Ÿè°ƒè¯•
- 422éªŒè¯é”™è¯¯ä¼šåœ¨æ§åˆ¶å°æ‰“å°è¯¦ç»†ä¿¡æ¯ï¼ˆmain.pyå¼‚å¸¸å¤„ç†å™¨ï¼‰
- å¥åº·æ£€æŸ¥æ¥å£: `GET /health/detailed` æ£€æŸ¥ç³»ç»ŸçŠ¶æ€
- è¯·æ±‚æ—¥å¿—ä¸­é—´ä»¶ä¼šè®°å½•æ‰€æœ‰APIè°ƒç”¨å’Œå“åº”æ—¶é—´
- æ•æ„Ÿä¿¡æ¯ï¼ˆå¯†ç ã€tokenç­‰ï¼‰åœ¨æ—¥å¿—ä¸­è‡ªåŠ¨è¿‡æ»¤

## æ–‡ä»¶ä¸Šä¼ ä¸é™æ€èµ„æº
- æ–‡ä»¶ä¸Šä¼ ç›®å½•ï¼š`backend/uploads/`
- è§†é¢‘æ–‡ä»¶å­˜å‚¨ï¼š`uploads/videos/`
- å›¾ç‰‡æ–‡ä»¶å­˜å‚¨ï¼š`uploads/images/`
- æ–‡æ¡£æ–‡ä»¶å­˜å‚¨ï¼š`uploads/documents/`
- é™æ€æ–‡ä»¶è®¿é—®ï¼š`http://localhost:8001/uploads/`ï¼ˆæ³¨æ„ç«¯å£æ˜¯8001ï¼‰
- å‰ç«¯é€šè¿‡ä»£ç†è®¿é—®ï¼š`http://localhost:3000/uploads/`

## å®‰å…¨é…ç½®
- JWT Tokenè®¤è¯
- CORSé…ç½®æ”¯æŒè·¨åŸŸ
- å¯†ç ä½¿ç”¨bcryptåŠ å¯†
- æƒé™ç®¡ç†åŸºäºè§’è‰²

## ç¬¬ä¸‰æ–¹æœåŠ¡é›†æˆ
- è…¾è®¯äº‘æœåŠ¡ï¼šè§†é¢‘é€šè¯ã€äº‘å­˜å‚¨
- WebSocketï¼šå®æ—¶é€šè®¯

## å¿«é€Ÿå¯åŠ¨å‘½ä»¤

### ä¸€é”®åˆå§‹åŒ–ï¼ˆé¦–æ¬¡ä½¿ç”¨ï¼‰
```bash
./setup.sh                    # è‡ªåŠ¨å®‰è£…ä¾èµ–ã€åˆå§‹åŒ–æ•°æ®åº“ã€å¯åŠ¨æœåŠ¡
python quick_test.py          # å¿«é€Ÿæ£€æµ‹ç³»ç»ŸçŠ¶æ€ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
```

âš ï¸ **æ³¨æ„**: start.shè„šæœ¬ç«¯å£é…ç½®æœ‰è¯¯ï¼Œå»ºè®®æ‰‹åŠ¨å¯åŠ¨æˆ–ä¿®å¤è„šæœ¬

### ç³»ç»Ÿè¯Šæ–­å’Œæµ‹è¯•å·¥å…·
```bash
# å®Œæ•´ä¸šåŠ¡æµç¨‹æµ‹è¯•ï¼ˆæ¨èï¼‰
python test_shopping.py       # æµ‹è¯•æ³¨å†Œâ†’ç™»å½•â†’è´­ç‰©â†’æ”¯ä»˜å®Œæ•´æµç¨‹

# ç«¯å£å ç”¨æ£€æŸ¥å·¥å…·ï¼ˆWindowsï¼‰
python kill_port_8001.py     # æ¸…ç†8001ç«¯å£å ç”¨ï¼ˆå¦‚éœ€è¦ï¼‰
netstat -ano | findstr :8001 # æ£€æŸ¥8001ç«¯å£çŠ¶æ€
netstat -ano | findstr :3000 # æ£€æŸ¥3000ç«¯å£çŠ¶æ€

# æœåŠ¡çŠ¶æ€æ£€æŸ¥
curl http://localhost:8001/health/detailed  # åç«¯å¥åº·æ£€æŸ¥
curl http://localhost:3000                  # å‰ç«¯è®¿é—®æ£€æŸ¥
```

### é¡¹ç›®ç®¡ç†
```bash
./start.sh                    # å¯åŠ¨æ‰€æœ‰æœåŠ¡ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
./stop.sh                     # åœæ­¢æ‰€æœ‰æœåŠ¡ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
./manage.sh                   # å›¾å½¢åŒ–ç®¡ç†ç•Œé¢ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
```

### æµ‹è¯•ä¸è¯Šæ–­
```bash
python quick_test.py          # ç³»ç»Ÿå¥åº·æ£€æŸ¥
./scripts/backup.sh           # æ•°æ®å¤‡ä»½ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
./scripts/restore.sh [å¤‡ä»½ID] # æ•°æ®æ¢å¤ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
```

## æ•°æ®åº“ç›¸å…³æ“ä½œ

### æ•°æ®åº“ç®¡ç†è„šæœ¬
```bash
cd backend
python create_admin.py              # åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·
python seed_data.py                 # åˆå§‹åŒ–åŸºç¡€æ•°æ®
python create_test_data.py          # åˆ›å»ºæµ‹è¯•æ•°æ®
python clean_and_recreate_data.py   # é‡ç½®æ•°æ®åº“
python recreate_db.py               # å®Œå…¨é‡å»ºæ•°æ®åº“ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
```

### æµ‹è¯•è´¦æˆ·ï¼ˆå¼€å‘ç”¨ï¼‰
- ç®¡ç†å‘˜: admin@tcm.com / admin123  
- æ™®é€šç”¨æˆ·: user@tcm.com / user123

## æœåŠ¡ç«¯å£é…ç½®
âœ… **ç«¯å£é…ç½®å·²ç»Ÿä¸€ä¿®å¤**
- **å‰ç«¯å¼€å‘æœåŠ¡å™¨**: http://localhost:3000 (Viteå¼€å‘æœåŠ¡å™¨)
- **åç«¯APIæœåŠ¡**: http://localhost:8001 (FastAPIæœåŠ¡å™¨)
- **APIæ–‡æ¡£**: http://localhost:8001/docs (Swaggeræ–‡æ¡£)
- **ç®¡ç†åå°**: http://localhost:3000/admin
- **å¥åº·æ£€æŸ¥**: http://localhost:8001/health/detailed
- **WebSocket**: ws://localhost:8001 (å®æ—¶é€šè®¯)
- **é™æ€æ–‡ä»¶è®¿é—®**: http://localhost:8001/uploads/ (é€šè¿‡å‰ç«¯ä»£ç†: http://localhost:3000/uploads/)
- **ç§»åŠ¨ç«¯H5**: æ ¹æ®UniAppé…ç½®çš„ç«¯å£
- **âœ… ä¿®å¤**: start.shè„šæœ¬ç«¯å£é…ç½®å·²æ›´æ­£ï¼Œä¸vite.config.tsä¿æŒä¸€è‡´

## æ•°æ®æ¨¡å‹å…³ç³»
- **ç”¨æˆ·ç³»ç»Ÿ**: User -> UserProfile (1:1)
- **ä¸“å®¶ç³»ç»Ÿ**: Expert -> User (å¤šå¯¹ä¸€)
- **è¯¾ç¨‹ç³»ç»Ÿ**: Course -> Lesson (ä¸€å¯¹å¤š), User -> Course (å¤šå¯¹å¤šå­¦ä¹ å…³ç³»)
- **è®¢å•ç³»ç»Ÿ**: Order -> OrderItem (ä¸€å¯¹å¤š), User -> Order (ä¸€å¯¹å¤š)
- **å’¨è¯¢ç³»ç»Ÿ**: Consultation -> User/Expert (å¤šå¯¹ä¸€å…³ç³»)
- **äº§å“ç³»ç»Ÿ**: Product -> Category (å¤šå¯¹ä¸€)

## é¡¹ç›®ç‰¹æ®Šæ–‡ä»¶è¯´æ˜

### å…³é”®é…ç½®æ–‡ä»¶
- **PINGPP_CONFIG.md** - Ping++æ”¯ä»˜èšåˆæœåŠ¡é…ç½®æ–‡æ¡£
- **nginx-dev.conf** - å¼€å‘ç¯å¢ƒNginxé…ç½®
- **ping_rsa_private_key.pem** - Ping++æ”¯ä»˜RSAç§é’¥ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
- **ping_rsa_private_key.pem.example** - RSAç§é’¥ç¤ºä¾‹æ–‡ä»¶

### æ ¸å¿ƒæ¶æ„æ–‡ä»¶
- **backend/app/core/enums_v2.py** - âœ… ç»Ÿä¸€æšä¸¾ç®¡ç†ç³»ç»Ÿï¼ˆæ”¯æŒçŠ¶æ€æœºå’Œå…ƒæ•°æ®ï¼‰
- **backend/app/core/exceptions.py** - ç»Ÿä¸€å¼‚å¸¸å¤„ç†ç³»ç»Ÿ
- **backend/app/core/response.py** - APIå“åº”æ ¼å¼æ ‡å‡†åŒ–
- **backend/app/core/exceptions.py** - ç»Ÿä¸€å¼‚å¸¸å¤„ç†
- **backend/app/core/response.py** - APIå“åº”æ ¼å¼æ ‡å‡†åŒ–

### å‰ç«¯ç‰¹æ®Šç»„ä»¶
- **frontend/src/components/EnumSelect.vue** - âœ… æšä¸¾é€‰æ‹©ç»„ä»¶ï¼ˆå·²é‡æ„ä¸º77è¡ŒåŒ…è£…å™¨ï¼‰
- **frontend/src/components/enum/** - âœ… æšä¸¾ç»„ä»¶æ¨¡å—ï¼ˆ4ä¸ªä¸“ç”¨ç»„ä»¶ï¼ŒèŒè´£æ¸…æ™°ï¼‰
- **frontend/src/services/** - å‰ç«¯æœåŠ¡å±‚å°è£…
- **frontend/src/utils/api.ts** - ç»Ÿä¸€APIè°ƒç”¨å·¥å…·

### æµ‹è¯•å’Œè°ƒè¯•è„šæœ¬
é¡¹ç›®é‡‡ç”¨è§„èŒƒçš„æµ‹è¯•ä½“ç³»ï¼š
- `backend/tests/` - âœ… ä¸“é—¨çš„æµ‹è¯•ç›®å½•
- `test_*.py` - åŠŸèƒ½æµ‹è¯•è„šæœ¬ï¼ˆå¦‚æœ‰éœ€è¦ï¼‰
- `debug_*.py` - è°ƒè¯•è¾…åŠ©è„šæœ¬
- `create_*.py` - æ•°æ®åˆå§‹åŒ–è„šï¿½ï¿½ï¿½

## é‡è¦æ¶æ„è¯´æ˜

### FastAPIåº”ç”¨ç»“æ„
- **ä¸»åº”ç”¨å…¥å£**: `backend/app/main.py` - åŒ…å«å…¨å±€å¼‚å¸¸å¤„ç†ã€CORSé…ç½®ã€ä¸­é—´ä»¶ã€é™æ€æ–‡ä»¶æŒ‚è½½
- **APIè·¯ç”±é›†åˆ**: `backend/app/api/api.py` - ç»Ÿä¸€è·¯ç”±æ³¨å†Œ
- **æ•°æ®åº“è¿æ¥**: `backend/app/database.py` - SQLAlchemyå¼•æ“å’Œä¼šè¯ç®¡ç†
- **é…ç½®ç®¡ç†**: `backend/app/core/config.py` - ç¯å¢ƒå˜é‡å’Œåº”ç”¨é…ç½®
- **æ ¸å¿ƒæ¨¡å—**: `backend/app/core/` - åŒ…å«ï¼š
  - `enums_v2.py` - âœ… ç»Ÿä¸€æšä¸¾å®šä¹‰ï¼ˆæ”¯æŒçŠ¶æ€æœºå’Œå…ƒæ•°æ®ï¼‰
  - `enums.py` - å·²ç§»é™¤æ—§ç‰ˆæšä¸¾ï¼ˆæ¶æ„ä¼˜åŒ–å®Œæˆï¼‰
  - `exceptions.py` - è‡ªå®šä¹‰å¼‚å¸¸ç±»ï¼ˆTCMExceptionåŸºç±»ï¼Œæ”¯æŒä¸šåŠ¡é”™è¯¯ç ï¼‰
  - `response.py` - ç»Ÿä¸€å“åº”æ ¼å¼ï¼ˆApiResponseå·¥å…·ç±»ï¼‰
  - `config.py` - ç¯å¢ƒé…ç½®å’Œåº”ç”¨è®¾ç½®
  - `reliable_pay.py` - æ”¯ä»˜æœåŠ¡å°è£…

### å‰ç«¯æ¶æ„ç‰¹ç‚¹
- **Vue 3 + Composition API**: ä½¿ç”¨æœ€æ–°çš„Vue3è¯­æ³•å’Œç»„åˆå¼API
- **è·¯ç”±æƒé™æ§åˆ¶**: ç®¡ç†å‘˜å’Œç”¨æˆ·è·¯ç”±åˆ†ç¦»ï¼Œç»Ÿä¸€æƒé™éªŒè¯
- **çŠ¶æ€ç®¡ç†**: Pinia storeç”¨äºç”¨æˆ·çŠ¶æ€å’Œè´­ç‰©è½¦ç®¡ç†
- **ç»„ä»¶åº“**: Element Plusæä¾›UIç»„ä»¶ï¼Œè‡ªå®šä¹‰ä¸šåŠ¡ç»„ä»¶åœ¨ `src/components/`
- **APIä»£ç†**: Viteé…ç½®ä»£ç†åˆ°åç«¯8001ç«¯å£ï¼ˆvite.config.tsï¼‰ï¼Œæ”¯æŒå¼€å‘æ—¶è·¨åŸŸ
- **ç»„ä»¶æ¶æ„**: âœ… ç»„ä»¶è®¾è®¡ä¼˜ç§€ï¼ŒèŒè´£æ¸…æ™°
  - `EnumSelect.vue` - âœ… æšä¸¾é€‰æ‹©ç»„ä»¶ï¼ˆå·²é‡æ„ä¸º77è¡ŒåŒ…è£…å™¨ï¼‰
  - `StatusTransition.vue` - çŠ¶æ€è½¬æ¢ç»„ä»¶
  - `NavigationBar.vue` - å¯¼èˆªæ ç»„ä»¶  
- **APIå·¥å…·**: `src/utils/api.ts` - ç»Ÿä¸€APIè°ƒç”¨å·¥å…·ï¼ˆåŒ…å«è‡ªåŠ¨tokenç®¡ç†å’Œé”™è¯¯å¤„ç†ï¼‰
- **æœåŠ¡å±‚**: `src/services/` - å‰ç«¯ä¸šåŠ¡æœåŠ¡å°è£…

### æ”¯ä»˜ç³»ç»Ÿé›†æˆ
é¡¹ç›®é›†æˆäº†å¤šç§æ”¯ä»˜æ–¹å¼ï¼š
- æ”¯ä»˜å®æ”¯ä»˜ (alipay-sdk-python)
- å¾®ä¿¡æ”¯ä»˜ (wechatpy)  
- **Ping++æ”¯ä»˜èšåˆ** (pingpp) - ä¸»è¦æ”¯ä»˜æ–¹æ¡ˆ
  - æ”¯æŒæ¨¡æ‹Ÿæ”¯ä»˜æ¨¡å¼ï¼ˆPINGPP_MOCK_MODE=trueï¼‰ - å½“å‰é»˜è®¤è®¾ç½®
  - é…ç½®æ–‡ä»¶ï¼š`PINGPP_CONFIG.md` - å®Œæ•´é…ç½®æŒ‡å—
  - APIç«¯ç‚¹ï¼š`/api/reliable-pay/` - æ”¯ä»˜æœåŠ¡æ¥å£
  - æ™ºèƒ½é™çº§ï¼šé…ç½®é”™è¯¯æ—¶è‡ªåŠ¨åˆ‡æ¢åˆ°æ¨¡æ‹Ÿæ”¯ä»˜
  - æµ‹è¯•å¯†é’¥ï¼šè§ `.env.example` æ–‡ä»¶
  - App IDï¼šè§ `.env.example` æ–‡ä»¶
  - **é‡è¦**: å› Python 3.13å…¼å®¹æ€§é—®é¢˜ï¼Œç›®å‰ä½¿ç”¨æ¨¡æ‹Ÿ+çœŸå®é…ç½®æ··åˆæ¨¡å¼

### æ”¯ä»˜æµ‹è¯•å‘½ä»¤
```bash
# å¿«é€Ÿæ”¯ä»˜åŠŸèƒ½æµ‹è¯•ï¼ˆæ¨èï¼‰
python test_shopping.py        # å®Œæ•´è´­ç‰©+æ”¯ä»˜æµç¨‹æµ‹è¯•

# æ”¯ä»˜APIå•ç‹¬æµ‹è¯•
curl -X POST http://localhost:8001/api/reliable-pay/create \
  -H "Content-Type: application/json" \
  -d '{"order_id":"TEST001","payment_method":"alipay_qr"}'

# æ¨¡æ‹Ÿæ”¯ä»˜æˆåŠŸ
curl -X POST http://localhost:8001/api/reliable-pay/simulate-success/TEST001
```

### æ•°æ®åº“è¯´æ˜
- **å¼€å‘ç¯å¢ƒ**: SQLiteæ•°æ®åº“ (`backend/tcm_backend.db`)
- **ç”Ÿäº§ç¯å¢ƒ**: æ”¯æŒPostgreSQL (é€šè¿‡DATABASE_URLç¯å¢ƒå˜é‡é…ç½®)
- **è¿ç§»ç®¡ç†**: Alembicç®¡ç†æ•°æ®åº“ç‰ˆæœ¬å’Œç»“æ„å˜æ›´ (ä½äº `backend/alembic/`)
- **æ•°æ®æ¨¡å‹**: ç»Ÿä¸€æšä¸¾å®šä¹‰é¿å…é‡å¤ï¼Œmodelså’Œschemasåˆ†ç¦»
- **å®¡è®¡å­—æ®µ**: æ‰€æœ‰ä¸»è¦è¡¨åŒ…å« created_at, updated_at, is_deleted å­—æ®µ
- **è½¯åˆ é™¤**: ä½¿ç”¨ is_deleted æ ‡å¿—å®ç°è½¯åˆ é™¤

### ä¸€é”®éƒ¨ç½²
- **å¿«é€Ÿå¯åŠ¨**: `./setup.sh` - å…¨è‡ªåŠ¨ç¯å¢ƒè®¾ç½®å’ŒæœåŠ¡å¯åŠ¨
- **æ—¥å¸¸ç®¡ç†**: `./start.sh` å¯åŠ¨æœåŠ¡ï¼Œ`./stop.sh` åœæ­¢æœåŠ¡
- **å¥åº·æ£€æŸ¥**: `python quick_test.py` æ£€æµ‹ç³»ç»ŸçŠ¶æ€

## å…³é”®ä¸šåŠ¡é€»è¾‘

### ç”¨æˆ·æƒé™ç³»ç»Ÿ
- **è§’è‰²å±‚çº§**: SUPER_ADMIN > ADMIN > DOCTOR > VIP > USER
- **JWTè®¤è¯**: ä½¿ç”¨ python-jose å®ç°ï¼Œtokenæœ‰æ•ˆæœŸå¯é…ç½®
- **æƒé™æ£€æŸ¥**: é€šè¿‡ä¾èµ–æ³¨å…¥åœ¨APIç«¯ç‚¹è¿›è¡Œæƒé™éªŒè¯

### æ”¯ä»˜æµç¨‹
1. ç”¨æˆ·ä¸‹å• â†’ åˆ›å»ºOrderè®°å½•
2. è°ƒç”¨æ”¯ä»˜æ¥å£ â†’ åˆ›å»ºPaymentè®°å½•
3. æ”¯ä»˜å›è°ƒ â†’ æ›´æ–°è®¢å•çŠ¶æ€
4. å‘é€é€šçŸ¥ â†’ å®Œæˆäº¤æ˜“

### æ–‡ä»¶å¤„ç†
- **ä¸Šä¼ é™åˆ¶**: å›¾ç‰‡10MBï¼Œè§†é¢‘100MBï¼Œæ–‡æ¡£5MB
- **æ–‡ä»¶ç±»å‹éªŒè¯**: åç«¯éªŒè¯MIMEç±»å‹å’Œæ–‡ä»¶æ‰©å±•å
- **è·¯å¾„ç»“æ„**: uploads/{type}/{year}/{month}/filename

## å¸¸è§é—®é¢˜æ’æŸ¥

### ç«¯å£å†²çªï¼ˆWindowsï¼‰
```bash
netstat -ano | findstr :8001  # æ£€æŸ¥8001ç«¯å£å ç”¨
netstat -ano | findstr :3000  # æ£€æŸ¥3000ç«¯å£å ç”¨
taskkill /F /PID <PID>        # å¼ºåˆ¶ç»“æŸè¿›ç¨‹
```

### æ•°æ®åº“é—®é¢˜
```bash
cd backend
rm tcm_backend.db           # åˆ é™¤æ•°æ®åº“é‡æ–°åˆå§‹åŒ–
alembic upgrade head        # é‡æ–°æ‰§è¡Œè¿ç§»
python create_admin.py      # é‡æ–°åˆ›å»ºç®¡ç†å‘˜
```

### å‰ç«¯æ„å»ºé—®é¢˜
```bash
cd frontend
rm -rf node_modules package-lock.json
npm install                 # é‡æ–°å®‰è£…ä¾èµ–
```

### APIè°ƒè¯•é—®é¢˜
```bash
# æ£€æŸ¥APIæœåŠ¡çŠ¶æ€
curl http://localhost:8001/health/detailed

# æµ‹è¯•ç™»å½•æ¥å£
python backend/debug_simple.py

# æŸ¥çœ‹æ•°æ®åº“å†…å®¹
sqlite3 backend/tcm_backend.db ".tables"  # æŸ¥çœ‹æ‰€æœ‰è¡¨
sqlite3 backend/tcm_backend.db "SELECT * FROM users LIMIT 5;"
```