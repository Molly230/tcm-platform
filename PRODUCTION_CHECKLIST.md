# 🚀 生产环境部署检查清单

**⚠️ 警告：未完成本清单的所有项目，请勿部署到生产环境！**

## 🔴 关键安全检查（必须完成）

### 1. 环境配置
- [ ] **复制 `.env.production` 为 `.env`**
- [ ] **修改 `DEBUG=False`**
- [ ] **设置强随机 `SECRET_KEY`**（至少32位）
- [ ] **设置强随机 `VIDEO_SECRET_KEY`**
- [ ] **配置正确的域名** `SERVER_HOST`
- [ ] **配置正确的CORS origins** `CORS_ORIGINS`

### 2. 数据库配置
- [ ] **使用PostgreSQL或MySQL**（不要使用SQLite）
- [ ] **数据库用户权限最小化**
- [ ] **设置数据库连接池**
- [ ] **配置数据库备份策略**
- [ ] **测试数据库连接**

### 3. 第三方服务配置
- [ ] **配置腾讯云密钥**（TENCENT_SECRET_ID/KEY）
- [ ] **配置支付宝密钥**（生产环境密钥）
- [ ] **配置微信支付密钥**（生产环境密钥）
- [ ] **验证所有第三方服务连接**

### 4. SSL/HTTPS配置
- [ ] **获取有效SSL证书**（不要用自签名）
- [ ] **配置HTTPS重定向**
- [ ] **配置HSTS头**
- [ ] **测试SSL配置**

## 🟡 安全强化（强烈建议）

### 5. 访问控制
- [ ] **配置防火墙**（只开放必要端口）
- [ ] **配置CDN/反向代理**
- [ ] **启用DDoS保护**
- [ ] **配置IP白名单**（管理后台）

### 6. 监控和日志
- [ ] **配置日志轮转**
- [ ] **设置错误告警**（邮件/短信）
- [ ] **配置性能监控**
- [ ] **设置磁盘空间监控**

### 7. 备份策略
- [ ] **配置自动数据库备份**
- [ ] **配置文件备份**
- [ ] **测试备份恢复**
- [ ] **设置异地备份**

## 🟢 运维准备（建议完成）

### 8. 性能优化
- [ ] **配置Redis缓存**
- [ ] **优化数据库索引**
- [ ] **配置静态文件CDN**
- [ ] **启用Gzip压缩**

### 9. 容错设计
- [ ] **配置服务重启策略**
- [ ] **设置健康检查**
- [ ] **配置负载均衡**（多实例）
- [ ] **准备降级预案**

### 10. 合规检查
- [ ] **医疗数据加密存储**
- [ ] **用户隐私协议更新**
- [ ] **医疗资质证书检查**
- [ ] **数据保护合规审计**

---

## 🛠️ 快速部署命令

### 开发环境测试
```bash
# 1. 安装依赖
cd backend && pip install -r requirements.txt
cd ../frontend && npm install

# 2. 启动服务
cd backend && uvicorn app.main:app --reload
cd frontend && npm run dev
```

### 生产环境部署
```bash
# 1. 检查配置
cp .env.production .env
# 编辑 .env 文件，填入真实配置

# 2. 构建前端
cd frontend && npm run build

# 3. 启动后端（使用进程管理器）
cd backend && gunicorn app.main:app -w 4 -k uvicorn.workers.UvicornWorker
```

---

## ⚠️ 部署前最终检查

运行以下命令进行最终检查：

```bash
# 检查配置文件
python scripts/check_production_config.py

# 测试数据库连接
python scripts/test_database.py

# 检查所有服务
python scripts/health_check.py
```

**如果任何检查失败，请不要部署！**

---

## 🆘 紧急联系方式

- **技术负责人**：请填写联系方式
- **运维负责人**：请填写联系方式  
- **安全负责人**：请填写联系方式

## 📋 部署记录

| 日期 | 版本 | 部署人 | 检查项完成度 | 备注 |
|------|------|--------|-------------|------|
| YYYY-MM-DD | v1.0.0 | 姓名 | ✅ 100% | 首次上线 |

**记住：安全第一，功能第二！**